## 黑马头条PC-内容列表-新建页面-挂载路由

**`思路-步骤`**

* 新建一个路由级组件 
* 挂载到二级路由上 => 按需加载

## 黑马头条PC-内容列表-页面结构-搜索工具栏

**`思路-步骤`**

* 表单容器 => model   rules => el-form => 这些属性是校验时必须写的,一般的绑定不需要写

>  

* ```html
   <el-form style="padding-left:50px">
           <el-form-item label="文章状态:">
             <!-- 放置单选框组 -->
             <el-radio-group>
               <!-- 单选框选项 -->
               <el-radio>全部</el-radio>
               <el-radio>草稿</el-radio>
               <el-radio>待审核</el-radio>
               <el-radio>审核通过</el-radio>
               <el-radio>审核失败</el-radio>
             </el-radio-group>
           </el-form-item>
           <el-form-item label="频道类型:">
             <!-- 选择器 -->
             <el-select placeholder="请选择频道"></el-select>
           </el-form-item>
           <el-form-item label="日期范围:">
             <!-- 日期范围选择组件  要设置type属性为 daterange-->
             <el-date-picker type='daterange'></el-date-picker>
           </el-form-item>
        </el-form>
    </el-card>
  ```
  
>  要对结构进行数据的绑定, 需要根据接口对数据进行分析 绑定

  先建立数据对象

  ```js
   searchForm: {
          // 数据
          // 文章状态，0-草稿，1-待审核，2-审核通过，3-审核失败，4-已删除，不传为全部 / 先将 5 定义成 全部
          // 传值的是时候如果是5 就不传
          status: 5, // 默认为全部的状态
          channel_id: null // 表示没有任何的频道
        }
  ```

  对 文章状态进行 绑定, 

  ```vue
  <el-radio-group v-model="searchForm.status">
               <!-- 单选框选项  label值表示该选项对应的值-->
               <!-- :label的意思是后面值不会加引号 -->
                <!-- 文章状态，0-草稿，1-待审核，2-审核通过，3-审核失败，不传为全部 / 先将 5 定义成 全部 -->
  
               <el-radio :label="5">全部</el-radio>
               <el-radio :label="0">草稿</el-radio>
               <el-radio :label="1">待审核</el-radio>
               <el-radio :label="2">审核通过</el-radio>
               <el-radio :label="3">审核失败</el-radio>
             </el-radio-group>
  ```

  >  频道列表的数据需要通过接口获取

  ```js
    // 获取频道数据
      getChannels () {
        this.$axios({
          url: '/channels'
        }).then(result => {
          // 获取频道接口返回的数据
          this.channels = result.data.channels
        })
      }
  ```

  >  钩子函数 created中调用

  绑定完成的最终代码是

  ```vue
    <el-card>
        <bread-crumb slot='header'>
            <template slot='title'>文章列表</template>
        </bread-crumb>
        <!-- 搜索工具栏 筛选 -->
        <!-- 表单容器 -->
        <el-form style="padding-left:50px">
           <el-form-item label="文章状态:">
             <!-- 放置单选框组 -->
             <el-radio-group v-model="searchForm.status">
               <!-- 单选框选项  label值表示该选项对应的值-->
               <!-- :label的意思是后面值不会加引号 -->
                <!-- 文章状态，0-草稿，1-待审核，2-审核通过，3-审核失败，不传为全部 / 先将 5 定义成 全部 -->
  
               <el-radio :label="5">全部</el-radio>
               <el-radio :label="0">草稿</el-radio>
               <el-radio :label="1">待审核</el-radio>
               <el-radio :label="2">审核通过</el-radio>
               <el-radio :label="3">审核失败</el-radio>
             </el-radio-group>
           </el-form-item>
           <el-form-item label="频道类型:">
             <!-- 选择器 -->
             <el-select placeholder="请选择频道" v-model="searchForm.channel_id">
               <!-- 下拉选项 应该通过接口来获取数据 -->
               <!-- el-option是下拉的选项 label是显示值  value是绑定的值 -->
               <el-option v-for="item in channels" :key="item.id" :label="item.name" :value="item.id"></el-option>
             </el-select>
           </el-form-item>
           <el-form-item label="日期范围:">
             <!-- 日期范围选择组件  要设置type属性为 daterange-->
             <el-date-picker type='daterange' v-model="searchForm.dateRange"></el-date-picker>
           </el-form-item>
  
        </el-form>
    </el-card>
  ```

  

  

## 黑马头条PC-内容列表-页面主体结构

>  

**`思路-步骤`**

* 手写的方式 实现页面的主题结构

* ```html
   <div class="article-item" v-for="item  in 100" :key="item">
           <!-- 左侧内容 -->
           <div class="left">
               <img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1583574111093&di=6f423a08762af8d11ecc47cd25891623&imgtype=0&src=http%3A%2F%2Fwww.sinaimg.cn%2Fdy%2Fslidenews%2F2_img%2F2016_23%2F792_1819513_700462.jpg" alt="">
               <div class="info">
                 <span>我爱我的祖国</span>
                 <el-tag class='tag'>已发表</el-tag>
                 <span class='date'>2020-02-18 10:12:19</span>
               </div>
           </div>
           <!-- 右侧内容 -->
           <div class="right">
             <span><i class="el-icon-edit"></i> 修改</span>
             <span><i class="el-icon-delete"></i> 删除</span>
           </div>
         </div>
  ```
  
  样式部分
  
  ```less
   .articles {
        .total {
          height: 60px;
          border-bottom: 1px dashed #ccc;
        }
        // 对文章循环项进行样式的编写
         .article-item {
           display: flex;
           justify-content: space-between;
           padding: 20px  0;
           border-bottom: 1px solid #ccc;
           .left {
             display: flex;
             img {
               width:180px;
               height: 100px;
               border-radius: 4px;
             }
             .info {
               display: flex;
               flex-direction: column;
               height: 100px;
               justify-content: space-around;
               margin-left: 10px;
               .date {
                 color: #999;
                 font-size:12px;
               }
               .tag {
                 width: 60px;
               text-align: center;
               }
             }
           }
           .right {
             span {
               font-size: 12px;
               margin-right: 8px;
               cursor: pointer;
               user-select: none;
             }
           }
         }
     }
  ```
  
  

## 黑马头条PC-内容列表-请求数据

**`思路-步骤`**

* 调用接口 =>先不做筛选,不做分页

>  调用完数据需要将 数据绑定到视图上



**`重点注意`**

 脚手架项目  写的源代码 都会被编译成 真实的运行代码 进行运行, 目录和名称都会变化

>  如果你给一个img标签 一个固定的地址,  地址所对应的文件 会被拷贝到一个对应的位置 ,使用

但是如果你 没有给一个图片固定地址, 而是采用了 判断 或者三元的写法, 这个时候 文件不会被拷贝及使用

>  怎么解决呢 ? 

可以先在data中 定义一个 变量,  用require()的方式 将图片转化成变量, 这个时候就可以使用了

```js
defaultImg: require('../../assets/img/default.gif') // 地址对应的文件变成了变量 在编译的时候会被拷贝到对应位置
```

```vue
 <!-- 列表内容 -->
      <!-- article-item 作为一个循环项 -->
       <div class="article-item" v-for="item  in  list" :key="item.id.toString()">
         <!-- 左侧内容 -->
         <div class="left">
           <!-- 设置文章的封面信息 有的数组有值 有的没值 搞一个默认值 -->
               <!-- <img src="../../assets/img/default.gif" alt=""> -->
              <!--  采用变量的形式 赋值 -->
             <img :src=" item.cover.images.length ?  item.cover.images[0] : defaultImg" alt="">
             <div class="info">
               <span>{{ item.title}}</span>
               <!-- 文章状态 0-草稿，1-待审核，2-审核通过，3-审核失败，4-已删除 -->
               <!-- 只是改变显示的格式 可以用过滤器   两个过滤器 分别处理   显示文本 和 标签类型-->
               <el-tag :type=" item.status | filterType" class='tag'>{{  item.status  | filterStatus}}</el-tag>
               <!-- 发布日期 -->
               <span class='date'>{{ item.pubdate }}</span>
             </div>
         </div>
         <!-- 右侧内容 -->
         <div class="right">
           <span><i class="el-icon-edit"></i> 修改</span>
           <span><i class="el-icon-delete"></i> 删除</span>
         </div>
       </div>
```

* 过滤器 不但可以用在插值表达式 

* 还可以用在 v-bind表达式

  

* ```js
      getArticles () {
        this.$axios({
          url: '/articles'
        }).then(result => {
          this.list = result.data.results // 获取文章列表数据
        })
      }
  ```

* 

## 黑马头条PC-内容列表-页面结构-搜索筛选

**`思路-步骤`**

>  我们已经加载了数据,但是并没有和搜索工具栏进行联通

接下来要做 和工具栏的联通问题

* 条件 => 组合条件 => 不论谁的数据发生变化 =>先组装条件  => 统一发送请求

* 第一种做法=>监听每个组件的change事件

* ```js
   // 改变了条件
      changeCondition () {
        // 当触发此方法的时候 表单数据已经变成最新的了
        // 组装条件 params
        const params = {
          // 文章状态，0-草稿，1-待审核，2-审核通过，3-审核失败，4-已删除，不传为全部
          status: this.searchForm.status === 5 ? null : this.searchForm.status, // 5 是我们前端虚构的
          channel_id: this.searchForm.channel_id, // 就是表单的数据
          begin_pubdate: this.searchForm.dateRange.length ? this.searchForm.dateRange[0] : null,
          end_pubdate: this.searchForm.dateRange.length > 1 ? this.searchForm.dateRange[1] : null
      }
        // 通过接口传入
        this.getArticles(params) // 直接调用获取方法
      },
  ```
  
* 第二种做法 => watch 去监听数据变化

>  watch  可以监听数据的变化, 监听谁 写谁的名字

如果监听对象呢? 如果对象里面套对象呢 ?

* ```js
  watch: {
      name: function(newValue,oldValue){
          
      }
  }
  // 传统模式  a: { b:{c:'123'} }
  watch:{
     "a.b.c":function(){}
  }
  watch: {
      a:{
          handler:function(){
              // this指向当前实例
          } // handler是一个固定写法 默认对象中任何的变化都会触发该函数
          deep: true // deep 深度检测 不论嵌套多少层 都可以监听到改变
      }
  }
  ```

  >  实施代码
  
  ```js
   // 监听data中的数据变化  第二种解决方案  watch监听对象的深度检测方案
    watch: {
      searchForm: {
        deep: true, // 固定写法 表示 会深度检测searchForm中的数据变化
        // handler也是一个固定写法 一旦数据发生任何变化 就会触发 更新
        handler () {
          //  统一调用改变条件的 方法
          this.changeCondition() // this 指向当前组件实例
        }
      }
    },
  ```
  
  

## 黑马头条PC-内容列表-分页请求

>  实现分页请求

放置分页组件,设置 total/page-size/current-page

```vue
   <!-- 放置分页组件 -->
       <el-row type='flex' justify="center" style='height:80px' align="middle">
             <!-- 分页组件 -->
             <el-pagination
              :current-page="page.currentPage"
              :page-size="page.pageSize"
              :total="page.total"
               background  layout='prev,pager,next'>
             </el-pagination>
       </el-row>
```

> 监听页码改变事件 @current-change

那么 切换页码的时候 需要带条件吗 ?

>  带! 应该带条件去翻页!

组装条件

> 条件改变的时候应该 回到第一页

```js
watch: {
    searchForm: {
      deep: true, // 固定写法 表示 会深度检测searchForm中的数据变化
      // handler也是一个固定写法 一旦数据发生任何变化 就会触发 更新
      handler () {
        //  统一调用改变条件的 方法
        this.page.currentPage = 1 // 只要条件变化 就变成第一页
        this.changeCondition() // this 指向当前组件实例
      }
    }
  },
```

> 页码改变 赋值新页码

```js
 // 改变页码事件
    changePage (newPage) {
      // 先将最新的页码给到 当前页码
      this.page.currentPage = newPage // 最新页码
      this.changeCondition() // 直接调用改变事件的方法
    },
```

> 切换条件的方法 

```js
  // 改变了条件
    changeCondition () {
      // 当触发此方法的时候 表单数据已经变成最新的了
      // 组装条件 params
      const params = {
        page: this.page.currentPage, // 如果条件改变 就回到第一页
        per_page: this.page.pageSize,
        // 文章状态，0-草稿，1-待审核，2-审核通过，3-审核失败，4-已删除，不传为全部
        status: this.searchForm.status === 5 ? null : this.searchForm.status, // 5 是我们前端虚构的
        channel_id: this.searchForm.channel_id, // 就是表单的数据
        begin_pubdate: this.searchForm.dateRange && this.searchForm.dateRange.length ? this.searchForm.dateRange[0] : null,
        end_pubdate: this.searchForm.dateRange && this.searchForm.dateRange.length > 1 ? this.searchForm.dateRange[1] : null
      }
      // 通过接口传入
      this.getArticles(params) // 直接调用获取方法
    },
```



## 黑马头条PC-内容列表-页面结构-删除内容

**`思路-步骤`**

****

> 自己的账户 不能发 正式内容,但是可以发草稿,可以用自己的账户测试删除草稿功能
>
> 139账户 发表的内容 可以不经过审核 就是正式内容

* 删除内容 => 只能删除 草稿 => 不能删除 已发表的  这是一种业务

* 注册删除的事件

* ```js
   // 删除素材方法
      delMaterial (id) {
      //  先友好的提示一下
        this.$confirm('您确定删除此条数据?', '提示').then(() => {
          // 如果进入了then 表示点击了确定
          this.$axios({
            method: 'delete',
            url: `/articles/${id}` // 地址 是  /articles/:target target 是文章id
          }).then(() => {
            // 如果删除成功了
            // 重新获取数据
          //  this.getArticles() // 如果这么写 就意味着你 舍去了当前的页码和条件 不能这么写
            // 应该带着条件和页码去加载
            this.changeCondition() // 重新加载
          }).catch(() => {
            this.$message.error('删除文章失败')
          })
        })
      },
```
  
* 

## 黑马头条PC-发表文章-新建页面-挂载路由

**`思路-步骤`**

* 路由级组件
* 挂载二级路由  => 按需加载

## 黑马头条PC-发表文章-页面结构-简单实现

**`思路-步骤`**

```html
<el-card>
      <bread-crumb slot='header'>
        <template slot='title'>
            发布文章
        </template>
      </bread-crumb>
      <!-- 容器 -->
      <el-form style="margin-left:50px" label-width="100px">
          <el-form-item label="标题">
              <el-input style="width:60%"></el-input>
          </el-form-item>
          <el-form-item label="内容">
                 <el-input
                 type="textarea"
                :rows="4"></el-input>
          </el-form-item>
          <el-form-item label="封面">
              <el-radio-group>
                  <el-radio>单图</el-radio>
                  <el-radio>三图</el-radio>
                  <el-radio>无图</el-radio>
                  <el-radio>自动</el-radio>
              </el-radio-group>
          </el-form-item>
          <el-form-item label="频道">
              <el-select></el-select>
          </el-form-item>
          <el-form-item>
              <el-button type='primary'>发布</el-button>
              <el-button>存入草稿</el-button>

          </el-form-item>
      </el-form>
  </el-card>
```



## 黑马头条PC-发表文章-频道数据加载

**`思路-步骤`**

## 黑马头条PC-发表文章-发布文章检验逻辑实现

**`思路-步骤`**

## 黑马头条PC-发表文章-发布文章

**`思路-步骤`**

## 黑马头条PC-修改文章-发布页面-简单模式跳转

**`思路-步骤`**

## 黑马头条PC-修改文章-逻辑实现

**`思路-步骤`**

## 黑马头条PC-发布文章-注册富文本编辑器

**`思路-步骤`**

## 黑马头条PC-发布文章-富文本编辑器应用

**`思路-步骤`**

## 黑马头条PC-发布文章-封面功能设计

**`思路-步骤`**

## 黑马头条PC-发布文章-封面功能实现